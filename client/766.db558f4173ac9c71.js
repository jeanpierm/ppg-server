"use strict";(self.webpackChunkppg_frontend=self.webpackChunkppg_frontend||[]).push([[766],{8766:(dt,y,a)=>{a.r(y),a.d(y,{AccountModule:()=>mt});var I=a(2289),u=a(6895),J=a(9814),s=a(4006),M=a(4466),m=a(1951),b=a(593),h=a(529),N=a(9591),t=a(4650),U=a(5953),f=a(3106),x=a(4859),l=a(3546),g=a(7392),d=a(9549),O=a(4144),L=a(1576),S=a(1716);function _(e,i){1&e&&(t.TgZ(0,"mat-error")(1,"mat-icon"),t._uU(2,"error"),t.qZA(),t._uU(3," La contrase\xf1a actual es requerida "),t.qZA())}function H(e,i){1&e&&(t.TgZ(0,"mat-error")(1,"mat-icon"),t._uU(2,"error"),t.qZA(),t._uU(3," La nueva contrase\xf1a es requerida "),t.qZA())}function k(e,i){if(1&e&&(t.TgZ(0,"mat-error")(1,"mat-icon"),t._uU(2,"error"),t.qZA(),t._uU(3),t.qZA()),2&e){const o=t.oxw();t.xp6(3),t.hij(" ",o.getPasswordValidationMsg()," ")}}function Y(e,i){1&e&&(t.TgZ(0,"mat-error")(1,"mat-icon"),t._uU(2,"error"),t.qZA(),t._uU(3," Debe confirmar su contrase\xf1a volvi\xe9ndola a escribir "),t.qZA())}function q(e,i){1&e&&(t.TgZ(0,"mat-error")(1,"mat-icon"),t._uU(2,"error"),t.qZA(),t._uU(3," Las contrase\xf1as no coinciden "),t.qZA())}let v=(()=>{class e{constructor(o,n,r){this.fb=o,this.accountService=n,this.alertService=r,this.hideCurrent=!0,this.hideNew=!0,this.hideNew2=!0,this.submitting=!1,this.form=this.fb.group({currentPassword:["",[s.kI.required]],newPassword:["",[s.kI.required,s.kI.minLength(8),s.kI.maxLength(30),s.kI.pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[#@$!%*?&.])([A-Za-z\d#@$!%*?&.]|[^ ])/)]],newPassword2:["",[s.kI.required]]},{validators:[(0,N.e)("newPassword","newPassword2")]})}get currentPassword(){return this.form.get("currentPassword")}get newPassword(){return this.form.get("newPassword")}get newPassword2(){return this.form.get("newPassword2")}cancel(){location.reload()}getPasswordValidationMsg(){const o=this.form.get("newPassword")?.value;if(o)return(0,N.r)(o)}updatePassword(){if(this.form.invalid)return;const{currentPassword:o,newPassword:n}=this.form.value;this.accountService.updatePassword({currentPassword:o,newPassword:n}).subscribe({next:()=>{this.alertService.success({title:"Contrase\xf1a actualizada con \xe9xito"}),this.form.reset()},error:r=>{r instanceof h.UA&&this.alertService.error(D[r.status])}})}}return e.PATH="change-password",e.\u0275fac=function(o){return new(o||e)(t.Y36(s.QS),t.Y36(U.B),t.Y36(f.c))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-change-password"]],decls:32,vars:13,consts:[["title","Cambiar contrase\xf1a"],[3,"formGroup","ngSubmit"],["fxLayout","column"],["appearance","outline"],["matInput","","formControlName","currentPassword","name","currentPassword",3,"type"],["matSuffix","",3,"click"],[4,"ngIf"],["matInput","","formControlName","newPassword","name","newPassword",3,"type"],["matInput","","formControlName","newPassword2","name","newPassword2",3,"type"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(o,n){1&o&&(t._UZ(0,"app-account-header",0),t.TgZ(1,"form",1),t.NdJ("ngSubmit",function(){return n.updatePassword()}),t.TgZ(2,"mat-card")(3,"mat-card-content",2)(4,"mat-form-field",3)(5,"mat-label"),t._uU(6,"Contrase\xf1a actual"),t.qZA(),t._UZ(7,"input",4),t.TgZ(8,"mat-icon",5),t.NdJ("click",function(){return n.hideCurrent=!n.hideCurrent}),t._uU(9),t.qZA(),t.YNc(10,_,4,0,"mat-error",6),t.qZA(),t.TgZ(11,"mat-form-field",3)(12,"mat-label"),t._uU(13,"Nueva contrase\xf1a"),t.qZA(),t._UZ(14,"input",7),t.TgZ(15,"mat-icon",5),t.NdJ("click",function(){return n.hideNew=!n.hideNew}),t._uU(16),t.qZA(),t.YNc(17,H,4,0,"mat-error",6),t.YNc(18,k,4,1,"mat-error",6),t.qZA(),t.TgZ(19,"mat-form-field",3)(20,"mat-label"),t._uU(21,"Confirmar nueva contrase\xf1a"),t.qZA(),t._UZ(22,"input",8),t.TgZ(23,"mat-icon",5),t.NdJ("click",function(){return n.hideNew2=!n.hideNew2}),t._uU(24),t.qZA(),t.YNc(25,Y,4,0,"mat-error",6),t.YNc(26,q,4,0,"mat-error",6),t.qZA()(),t.TgZ(27,"mat-card-actions")(28,"button",9),t.NdJ("click",function(){return n.cancel()}),t._uU(29,"Cancelar"),t.qZA(),t.TgZ(30,"button",10),t._uU(31," Establecer nueva contrase\xf1a "),t.qZA()()()()),2&o&&(t.xp6(1),t.Q6J("formGroup",n.form),t.xp6(6),t.Q6J("type",n.hideCurrent?"password":"text"),t.xp6(2),t.Oqu(n.hideCurrent?"visibility_off":"visibility"),t.xp6(1),t.Q6J("ngIf",null==n.currentPassword?null:n.currentPassword.hasError("required")),t.xp6(4),t.Q6J("type",n.hideNew?"password":"text"),t.xp6(2),t.Oqu(n.hideNew?"visibility_off":"visibility"),t.xp6(1),t.Q6J("ngIf",null==n.newPassword?null:n.newPassword.hasError("required")),t.xp6(1),t.Q6J("ngIf",null==n.newPassword?null:n.newPassword.hasError("pattern")),t.xp6(4),t.Q6J("type",n.hideNew2?"password":"text"),t.xp6(2),t.Oqu(n.hideNew2?"visibility_off":"visibility"),t.xp6(1),t.Q6J("ngIf",null==n.newPassword2?null:n.newPassword2.hasError("required")),t.xp6(1),t.Q6J("ngIf",n.form.hasError("doNotMatch")),t.xp6(4),t.Q6J("disabled",n.submitting))},dependencies:[u.O5,x.lW,l.a8,l.dn,l.hq,g.Hw,d.TO,d.KE,d.hX,d.R9,O.Nt,s._Y,s.Fj,s.JJ,s.JL,L.xw,s.sg,s.u,S.G],styles:["mat-card[_ngcontent-%COMP%]{margin:24px auto;max-width:660px}mat-card-actions[_ngcontent-%COMP%]{text-align:right}"]}),e})();const D={400:{title:"La contrase\xf1a actual no es correcta"}};var C=a(752),Q=a(7838),G=a(1572),z=a(455);function j(e,i){1&e&&t._UZ(0,"mat-spinner")}function B(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"mat-card-content")(1,"p"),t._uU(2," Edita cuales datos de tu cuenta deseas que aparezcan en la descarga de un perfil profesional: "),t.qZA(),t.TgZ(3,"mat-slide-toggle",4),t._uU(4," Foto "),t.qZA(),t.TgZ(5,"mat-slide-toggle",5),t._uU(6," Correo electr\xf3nico "),t.qZA(),t.TgZ(7,"mat-slide-toggle",6),t._uU(8," Biograf\xeda "),t.qZA(),t.TgZ(9,"mat-slide-toggle",7),t._uU(10," Enlace de LinkedIn "),t.qZA(),t.TgZ(11,"mat-slide-toggle",8),t._uU(12," Enlace de GitHub "),t.qZA(),t.TgZ(13,"mat-slide-toggle",9),t._uU(14," Enlace de portafolio "),t.qZA()(),t.TgZ(15,"mat-card-actions")(16,"button",10),t.NdJ("click",function(){t.CHM(o);const r=t.oxw();return t.KtG(r.cancel())}),t._uU(17," Cancelar "),t.qZA(),t.TgZ(18,"button",11),t._uU(19," Editar descarga de perfil "),t.qZA()()}if(2&e){const o=t.oxw();t.xp6(18),t.Q6J("disabled",o.submitting)}}let P=(()=>{class e{constructor(o,n,r){this.fb=o,this.dpService=n,this.alertService=r,this.submitting=!1,this.loadingData=!0,this.form=this.fb.group({photo:[!1],email:[!1],biography:[!1],linkedIn:[!1],github:[!1],portfolio:[!1]})}ngOnInit(){this.loadAccountDataInForm()}loadAccountDataInForm(){this.loadingData=!0,this.dpService.get().subscribe(({data:o})=>{this.form.setValue({photo:o.photo,email:o.email,biography:o.biography,linkedIn:o.linkedIn,github:o.github,portfolio:o.portfolio}),this.loadingData=!1})}updateDownloadProfile(){this.submitting=!0,this.dpService.patch({photo:this.form.value.photo,email:this.form.value.email,biography:this.form.value.biography,linkedIn:this.form.value.linkedIn,github:this.form.value.github,portfolio:this.form.value.portfolio}).subscribe({next:()=>{this.submitting=!1,this.alertService.success({title:"Preferencias actualizadas con \xe9xito"})},error:n=>{this.submitting=!1,n instanceof h.UA&&this.alertService.error()}})}cancel(){location.reload()}}return e.PATH="edit-download",e.\u0275fac=function(o){return new(o||e)(t.Y36(s.QS),t.Y36(Q.a),t.Y36(f.c))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-edit-download"]],decls:6,vars:3,consts:[["title","Editar descarga de perfil"],[3,"formGroup","ngSubmit"],[4,"ngIf","ngIfElse"],["formContent",""],["formControlName","photo","name","photo"],["formControlName","email","name","email"],["formControlName","biography","name","biography"],["formControlName","linkedIn","name","linkedIn"],["formControlName","github","name","github"],["formControlName","portfolio","name","portfolio"],["mat-button","","color","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(o,n){if(1&o&&(t._UZ(0,"app-account-header",0),t.TgZ(1,"form",1),t.NdJ("ngSubmit",function(){return n.updateDownloadProfile()}),t.TgZ(2,"mat-card"),t.YNc(3,j,1,0,"mat-spinner",2),t.YNc(4,B,20,1,"ng-template",null,3,t.W1O),t.qZA()()),2&o){const r=t.MAs(5);t.xp6(1),t.Q6J("formGroup",n.form),t.xp6(2),t.Q6J("ngIf",n.loadingData)("ngIfElse",r)}},dependencies:[u.O5,x.lW,l.a8,l.dn,l.hq,G.Ou,z.Rr,s._Y,s.JJ,s.JL,s.sg,s.u,S.G],styles:["mat-card[_ngcontent-%COMP%]{margin:24px auto;max-width:660px}mat-card-actions[_ngcontent-%COMP%]{text-align:right}form[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{margin:8px 0;display:block}mat-spinner[_ngcontent-%COMP%]{margin:auto}"]}),e})();var p=a(3151);const V=[{path:"",component:b.P,children:[{path:p.C.PATH,component:p.C},{path:C.V.PATH,component:C.V},{path:v.PATH,component:v},{path:P.PATH,component:P},{path:"**",redirectTo:p.C.PATH}]}];let R=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[m.Bz.forChild(V),m.Bz]}),e})();var $=a(8423),X=a(2331),F=a(6338);function K(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"a",1),t.NdJ("click",function(){t.CHM(o);const r=t.oxw();return t.KtG(r.clickOption.emit(!0))}),t.TgZ(1,"mat-icon",2),t._uU(2),t.qZA(),t.TgZ(3,"span",3),t._uU(4),t.qZA()()}if(2&e){const o=i.$implicit;t.Q6J("routerLink",o.path),t.xp6(2),t.hij(" ",o.icon," "),t.xp6(2),t.hij(" ",o.label," ")}}let W=(()=>{class e{constructor(){this.menuOptions=[{icon:"home",label:"Visi\xf3n general de mi cuenta",path:p.C.PATH},{icon:"edit",label:"Editar cuenta",path:C.V.PATH},{icon:"lock",label:"Cambiar contrase\xf1a",path:v.PATH},{icon:"app_registration",label:"Editar descarga de perfil",path:P.PATH}],this.clickOption=new t.vpe}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-account-nav-list"]],outputs:{clickOption:"clickOption"},decls:2,vars:1,consts:[["mat-list-item","",3,"routerLink","click",4,"ngFor","ngForOf"],["mat-list-item","",3,"routerLink","click"],["color","primary",1,"sidenav-icon"],[1,"ml-3"]],template:function(o,n){1&o&&(t.TgZ(0,"mat-nav-list"),t.YNc(1,K,5,3,"a",0),t.qZA()),2&o&&(t.xp6(1),t.Q6J("ngForOf",n.menuOptions))},dependencies:[u.sg,g.Hw,F.Hk,F.Tg,m.yS]}),e})();var tt=a(6805),ot=a(930);function E(e,i){const o="object"==typeof i;return new Promise((n,r)=>{const c=new ot.Hp({next:T=>{n(T),c.unsubscribe()},error:r,complete:()=>{o?n(i.defaultValue):r(new tt.K)}});e.subscribe(c)})}var et=a(5226),w=a.n(et),nt=a(1186),at=a(4004),rt=a(2340);let it=(()=>{class e{constructor(o){this.http=o}uploadFile(o){const n=`${rt.N.cloudinaryApi}/jean-cloudinary/upload`,r=new FormData;return r.append("file",o,o.name),r.append("upload_preset","ppg-ug"),this.http.post(n,r).pipe((0,at.U)(c=>c.secure_url))}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(h.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Z=a(8255),st=a(5829);const ct=["photo"],lt=["fileInput"];let ut=(()=>{class e{constructor(o,n,r,c){this.authService=o,this.alertService=n,this.cloudinaryService=r,this.accountService=c,this.defaultPhotoUrl="https://t4.ftcdn.net/jpg/00/64/67/63/360_F_64676383_LdbmhiNM6Ypzb3FM4PPuFP9rHe7ri8Ju.jpg",this.account=this.authService.authAccount}get photoStyle(){return{"background-image":`url(${this.account.photo||this.defaultPhotoUrl})`}}get fullName(){if(!this.account)return;const{name:o,surname:n}=this.account;return`${o} ${n}`}ngAfterViewInit(){this.setListenersForHoverPhoto()}setListenersForHoverPhoto(){this.photo.nativeElement.addEventListener("mouseenter",()=>{this.photo.nativeElement.innerText="CAMBIAR FOTO"}),this.photo.nativeElement.addEventListener("mouseout",()=>{this.photo.nativeElement.innerText=""})}uploadAccountPhoto(){const{files:o}=this.fileInput.nativeElement;o?.length&&(w().fire({title:"Subiendo...",text:"Por favor, espere...",allowOutsideClick:!1,showConfirmButton:!1,didOpen:()=>{w().showLoading()}}),this.cloudinaryService.uploadFile(o[0]).subscribe(r=>{E(this.accountService.updateAccount({photo:r})).then(()=>{w().close(),this.account.photo=r,this.alertService.success({title:"Foto de perfil actualizada con \xe9xito"})})}))}removeAccountPhoto(){E(this.accountService.updateAccount({photo:""})).then(()=>{this.account.photo="",this.alertService.success({title:"Foto de perfil eliminada"})})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(nt.e),t.Y36(f.c),t.Y36(it),t.Y36(U.B))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-photo"]],viewQuery:function(o,n){if(1&o&&(t.Gf(ct,5),t.Gf(lt,5)),2&o){let r;t.iGM(r=t.CRH())&&(n.photo=r.first),t.iGM(r=t.CRH())&&(n.fileInput=r.first)}},decls:20,vars:6,consts:[[1,"photo-container"],["id","photo","alt","account photo",3,"ngStyle","matMenuTriggerFor"],["photo",""],["menu","matMenu"],["mat-menu-item","",3,"click"],[1,"account-name"],["type","file",2,"display","none",3,"change"],["fileInput",""]],template:function(o,n){if(1&o){const r=t.EpF();t.TgZ(0,"div",0),t._UZ(1,"div",1,2),t.TgZ(3,"mat-menu",null,3)(5,"button",4),t.NdJ("click",function(){t.CHM(r);const T=t.MAs(19);return t.KtG(T.click())}),t.TgZ(6,"mat-icon"),t._uU(7,"upload"),t.qZA(),t._uU(8," Subir foto "),t.qZA(),t.TgZ(9,"button",4),t.NdJ("click",function(){return n.removeAccountPhoto()}),t.TgZ(10,"mat-icon"),t._uU(11,"delete"),t.qZA(),t._uU(12," Eliminar foto "),t.qZA()(),t.TgZ(13,"h3",5),t._uU(14),t.ALo(15,"titlecase"),t.qZA(),t.TgZ(16,"mat-card-subtitle"),t._uU(17),t.qZA()(),t.TgZ(18,"input",6,7),t.NdJ("change",function(){return n.uploadAccountPhoto()}),t.qZA()}if(2&o){const r=t.MAs(4);t.xp6(1),t.Q6J("ngStyle",n.photoStyle)("matMenuTriggerFor",r),t.xp6(13),t.Oqu(t.lcZ(15,4,n.fullName)),t.xp6(3),t.Oqu(n.account.biography)}},dependencies:[u.PC,l.$j,g.Hw,Z.VK,Z.OP,Z.p6,st.Zl,u.rS],styles:["#photo[_ngcontent-%COMP%]{background-position:center;background-repeat:no-repeat;background-size:cover;background-blend-mode:darken;width:128px;height:128px;border-radius:50%;display:flex;justify-content:center;align-items:center;font-weight:700;color:#fff;margin:0;overflow:hidden;text-align:center;padding:0;font-size:12px;cursor:pointer}#photo[_ngcontent-%COMP%]:hover{background-color:#00000080}.photo-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;margin-top:2rem;margin-bottom:1rem}.account-name[_ngcontent-%COMP%]{margin-top:.75rem;margin-bottom:.5rem;font-size:large;font-weight:500}"]}),e})();var A=a(3267);let mt=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[u.ez,X.q,s.u5,I.xu,J.o9,M.m,R,s.UX,$.ef]}),e})();t.B6R(b.P,[A.JX,A.TM,A.Rh,m.lC,W,ut],[])}}]);